# RAG - Интеграция LLM с внешней базой знаний

## Описание проекта
В данном проекте мы разработали систему, которая интегрирует большую языковую модель (LLM) с внешней базой знаний для улучшения ответов на вопросы пользователей. Мы использовали архитектуру **Retrieval-Augmented Generation (RAG)**, которая сначала извлекает релевантную информацию из базы знаний, а затем использует её для генерации более точных и детализированных ответов. 

Система включает в себя:
- **ChromaDB** для хранения и поиска векторных представлений текстов (эмбеддингов).
- **Sentence-BERT** для генерации эмбеддингов вопросов и документов.
- **FLAN-T5** как основная языковая модель для генерации ответов.
- **Beam search** для улучшения качества генерации.

## Файлы
- **data/dev-v1.1.json и data/dev-v2.0.json** — JSON-файлы с контекстами и вопросами, используемые для базы знаний.
- **merged_dataset.json** — объединённый датасет, содержащий все данные для базы знаний.
- **notebook.ipynb** — Jupyter Notebook, содержащий код для обработки текстов, генерации эмбеддингов, работы с ChromaDB и генерации ответов.

## Структура данных
Мы используем текстовые данные в формате JSON с вопросами и соответствующими контекстами. Пример структуры данных:
```json
{
  "question": "How much literature has been written regarding civil disobedience?",
  "answers": [
    {"answer_start": 268, "text": "semantical problems and grammatical niceties"}
  ],
  "id": "5728d7c54b864d1900164f4d"
}
```

## Как это работает
1. **Генерация эмбеддингов**: С помощью Sentence-BERT мы преобразуем контексты и вопросы в эмбеддинги для эффективного поиска.
2. **Сохранение в ChromaDB**: Эмбеддинги сохраняются в ChromaDB, где они индексируются для быстрого поиска.
3. **Поиск по базе знаний**: При задании вопроса система ищет релевантные документы в базе знаний с использованием их эмбеддингов.
4. **Генерация ответа**: Извлечённая информация передаётся модели FLAN-T5, которая генерирует финальный ответ, основываясь на контексте.

## Пример 
Вопрос: "Как гражданское неповиновение влияет на современные правовые системы?"

Ответ от базовой модели (без знаний): "Закон о послушании основан на законе о послушании."

Ответ от модели с базой знаний: "Гражданское неповиновение обычно определяется как отношение гражданина к государству и его законам."


Для большего ознакомления с проектом, посмотрите мой блокнот! 
